This code borrows heavily from Android sample project called NetworkConnect.  See that project for license.
